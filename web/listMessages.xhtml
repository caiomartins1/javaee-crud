<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
>
  <h:head>
    <title>Messages</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
  </h:head>

  <h:body>
    <!--Nav Bar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="/">
        <h3 class="ml-2">XPTO Car Shop</h3>
      </a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <c:if test="#{UsersController.loginBean.userID > 0}">
            <h:form>
              <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                  <h:commandLink class="nav-link" value="About Us" />
                </li>
                <li class="nav-item">
                  <h:commandLink class="nav-link" value="Contact" />
                </li>
                <li class="nav-item">
                  <h:commandLink
                    class="nav-link"
                    value="Logout"
                    action="#{UsersController.logoutUser()}"
                  />
                </li>
              </ul>
            </h:form>
          </c:if>
          <c:if test="#{UsersController.loginBean.userID == -1}">
            <h:form>
              <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                  <h:commandLink class="nav-link" value="About Us" />
                </li>
                <li class="nav-item">
                  <h:commandLink class="nav-link" value="Contact" />
                </li>
              </ul>
            </h:form>
          </c:if>
        </ul>
      </div>
    </nav>

    <!-- Table -->
    <div class="container mt-5">
      <table class="table">
        <thead class="thead-dark">
          <tr>
            <th scope="col">Message ID</th>
            <th scope="col">Message</th>
            <th scope="col">Date</th>
          </tr>
        </thead>
        <tbody>
            <h:form>
                <h:inputHidden value="#{MessagesController.generateMessages()}" />
            </h:form>
          <c:forEach
              items="#{MessagesController.messagesList}"
            var="message"
            varStatus="metadata"
          >
            <tr>
              <td>#{message.id}</td>
              <td>#{message.message}</td>
              <td>#{message.reveivedAt.year}</td>
            </tr>
          </c:forEach>
        </tbody>
      </table>
    </div>

    <!-- Bootstrap JavaScript Files -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
      integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
      crossorigin="anonymous"
    ></script>
  </h:body>
</html>
